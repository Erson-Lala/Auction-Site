{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\Freelancing\\\\Test\\\\React-Firebase-Auth-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\Freelancing\\\\Test\\\\React-Firebase-Auth-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:\\\\Freelancing\\\\Test\\\\React-Firebase-Auth-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Container}from'react-bootstrap';import NavBar from'../NavBar';import{Card}from\"react-bootstrap\";import'../newAuction/newAuctionStyle.css';import'./bidStyle.css';import toast,{Toaster}from'react-hot-toast';import{useLocation,useNavigate}from'react-router-dom';import{doc,updateDoc,getDoc}from'firebase/firestore';import{db}from'../../firebase';export default function Bid(){var navigate=useNavigate();var location=useLocation();var auctionItemData=location.state.auctionItemData;var AuctionItemID=location.state.ItemId;var _useState=useState(),_useState2=_slicedToArray(_useState,2),newBid=_useState2[0],setNewBid=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loader=_useState4[0],setLoader=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userData=_useState6[0],setUserData=_useState6[1];var userId=JSON.parse(localStorage.getItem(\"UserID\"));var userName=JSON.parse(localStorage.getItem(\"User\"));useEffect(function(){var docRef=doc(db,'Users',userId);getDoc(docRef).then(function(doc){setUserData(doc.data());});},[]);var handleEnterBid=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var docRef,newBalance,_docRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoader(true);if(!(parseFloat(auctionItemData.topBid)>=parseFloat(newBid))){_context.next=5;break;}toast.error(\"Your bid is less than top bid \");setLoader(false);return _context.abrupt(\"return\");case 5:if(!(userData.wallet<parseFloat(newBid))){_context.next=9;break;}toast.error(\"Your wallet balance is insufficient\");setLoader(false);return _context.abrupt(\"return\");case 9:_context.prev=9;docRef=doc(db,'Auction',AuctionItemID);_context.next=13;return updateDoc(docRef,{topBid:newBid,topBidUser:userName.name});case 13:toast.success(\"Your bid is now highest\");_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](9);toast.error(\"Server encounter an unexception condition\");case 19:newBalance=userData.wallet-parseFloat(newBid);// The User Wallet Balnce handle\n_context.prev=20;_docRef=doc(db,'Users',userId);_context.next=24;return updateDoc(_docRef,{wallet:newBalance});case 24:setLoader(false);navigate(\"/homes\");setTimeout(function(){toast.success(\"Your remaining balance is: \".concat(newBalance));return;},1000);_context.next=32;break;case 29:_context.prev=29;_context.t1=_context[\"catch\"](20);toast.error(\"Server encounter an unexception condition\");case 32:case\"end\":return _context.stop();}}},_callee,null,[[9,16],[20,29]]);}));return function handleEnterBid(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(NavBar,{title:auctionItemData.productName,createdBy:auctionItemData.sellerName}),/*#__PURE__*/React.createElement(Card,{className:\"w-100\",style:{maxWidth:\"1200px\"}},/*#__PURE__*/React.createElement(Card.Body,null,/*#__PURE__*/React.createElement(\"h6\",{className:\"time_tag\"},\"Time Remaining: \",auctionItemData.timeRemaining,\" Days\"),/*#__PURE__*/React.createElement(\"p\",null,auctionItemData.Description),/*#__PURE__*/React.createElement(\"div\",{className:\"biding_information\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"hieghest_bid\"},\"Current High Bid\"),/*#__PURE__*/React.createElement(\"p\",{className:\"hieghest_bid\"},auctionItemData.topBid)),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"hieghest_bid\"},\"By:  \",auctionItemData.topBidUser))),/*#__PURE__*/React.createElement(\"footer\",{className:\"Input_Box\"},/*#__PURE__*/React.createElement(\"label\",{className:\"your_Bid\"},\"Your Bid:\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Enter your Bid\",className:\"input_for_new_bids\",onChange:function onChange(e){setNewBid(e.target.value);}}),!loader?/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-sm btn-success bid_button\",onClick:function onClick(){return handleEnterBid();}},\"Enter Bid\"):/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-sm btn-success bid_button\"},/*#__PURE__*/React.createElement(\"span\",{class:\"spinner-grow spinner-grow-sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"Please wait\")))),/*#__PURE__*/React.createElement(Toaster,null));}","map":{"version":3,"sources":["E:/Freelancing/Test/React-Firebase-Auth-master/src/components/biding/Bid.js"],"names":["React","useState","useEffect","Container","NavBar","Card","toast","Toaster","useLocation","useNavigate","doc","updateDoc","getDoc","db","Bid","navigate","location","auctionItemData","state","AuctionItemID","ItemId","newBid","setNewBid","loader","setLoader","userData","setUserData","userId","JSON","parse","localStorage","getItem","userName","docRef","then","data","handleEnterBid","parseFloat","topBid","error","wallet","topBidUser","name","success","newBalance","setTimeout","productName","sellerName","maxWidth","timeRemaining","Description","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Container } from 'react-bootstrap'\r\nimport NavBar from '../NavBar'\r\nimport { Card } from \"react-bootstrap\"\r\nimport '../newAuction/newAuctionStyle.css'\r\nimport './bidStyle.css'\r\nimport toast, { Toaster } from 'react-hot-toast';\r\nimport { useLocation ,useNavigate} from 'react-router-dom'\r\nimport { doc, updateDoc, getDoc } from 'firebase/firestore'\r\nimport { db } from '../../firebase'\r\nexport default function Bid() {\r\n     const navigate = useNavigate()\r\n     const location = useLocation();\r\n     const auctionItemData = location.state.auctionItemData\r\n     const AuctionItemID = location.state.ItemId\r\n     const [newBid, setNewBid] = useState()\r\n     const [loader, setLoader] = useState(false)\r\n     const [userData, setUserData] = useState()\r\n     const userId = JSON.parse(localStorage.getItem(\"UserID\"))\r\n     const userName = JSON.parse(localStorage.getItem(\"User\"))\r\n\r\n     \r\n     useEffect(() => {\r\n          const docRef = doc(db, 'Users', userId)\r\n          getDoc(docRef)\r\n               .then((doc) => {\r\n                    setUserData(doc.data())\r\n               })\r\n     }, [])\r\n     const handleEnterBid = async () => {\r\n          setLoader(true)\r\n          if (parseFloat(auctionItemData.topBid) >= parseFloat(newBid)) {\r\n               toast.error(\"Your bid is less than top bid \")\r\n               setLoader(false)\r\n               return\r\n          }\r\n          if (userData.wallet < parseFloat(newBid)) {\r\n               toast.error(\"Your wallet balance is insufficient\")\r\n               setLoader(false)\r\n               return\r\n          }\r\n          try {\r\n               const docRef = doc(db, 'Auction', AuctionItemID)\r\n               await updateDoc(docRef, {\r\n                    topBid: newBid,\r\n                    topBidUser: userName.name\r\n\r\n               })\r\n               toast.success(\"Your bid is now highest\")\r\n          } catch (e) {\r\n               toast.error(\"Server encounter an unexception condition\")\r\n          }\r\n          const newBalance = userData.wallet - parseFloat(newBid)\r\n          // The User Wallet Balnce handle\r\n          try {\r\n               const docRef = doc(db, 'Users', userId)\r\n               await updateDoc(docRef, {\r\n                    wallet: newBalance\r\n               })\r\n               setLoader(false)\r\n               navigate(\"/homes\")\r\n               setTimeout(() => {\r\n                    toast.success(`Your remaining balance is: ${newBalance}`)\r\n                    return\r\n               }, 1000)\r\n          } catch (e) {\r\n               toast.error(\"Server encounter an unexception condition\")\r\n          }\r\n     }\r\n     return (\r\n          <Container>\r\n               <NavBar title={auctionItemData.productName} createdBy={auctionItemData.sellerName} />\r\n               <Card className=\"w-100\" style={{ maxWidth: \"1200px\" }}>\r\n                    <Card.Body>\r\n                         <h6 className='time_tag'>Time Remaining: {auctionItemData.timeRemaining} Days</h6>\r\n                         <p>{auctionItemData.Description}</p>\r\n                         <div className=\"biding_information\">\r\n                              <div>\r\n                                   <p className='hieghest_bid'>Current High Bid</p>\r\n                                   <p className='hieghest_bid'>{auctionItemData.topBid}</p>\r\n                              </div>\r\n                              <div>\r\n                                   <p className='hieghest_bid'>By:  {auctionItemData.topBidUser}</p>\r\n                              </div>\r\n                         </div>\r\n                         <footer className='Input_Box'>\r\n                              <label className='your_Bid'>Your Bid:</label>\r\n                              <input type='text' placeholder='Enter your Bid' className='input_for_new_bids' onChange={(e) => { setNewBid(e.target.value) }}></input>\r\n                              {!loader ?\r\n                                   <button type=\"button\" className=\"btn btn-sm btn-success bid_button\" onClick={() => handleEnterBid()}>Enter Bid</button>\r\n                                   :\r\n                                   <button type=\"button\" className=\"btn btn-sm btn-success bid_button\">\r\n                                        <span class=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span>  \r\n                                        Please wait        \r\n                                   </button> \r\n                              }\r\n                         </footer>\r\n                    </Card.Body>\r\n               </Card>\r\n               <Toaster />\r\n          </Container>\r\n     )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}